\hypertarget{WhisperInterface_8py_source}{}\doxysection{Whisper\+Interface.\+py}
\label{WhisperInterface_8py_source}\index{Content/Python/OpenAccessibilityPy/WhisperInterface.py@{Content/Python/OpenAccessibilityPy/WhisperInterface.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00001}00001 \textcolor{keyword}{from} ctypes \textcolor{keyword}{import} Union}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00002}00002 \textcolor{keyword}{import} numpy \textcolor{keyword}{as} np}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00003}00003 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00004}00004 \textcolor{keyword}{from} faster\_whisper \textcolor{keyword}{import} WhisperModel}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00005}00005 \textcolor{keyword}{from} faster\_whisper.transcribe \textcolor{keyword}{import} Segment}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00006}00006 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00007}00007 \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00008}00008     \textcolor{keyword}{from} .Logging \textcolor{keyword}{import} Log, LogLevel}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00009}00009 \textcolor{keywordflow}{except} ImportError:}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00010}00010     \textcolor{keyword}{from} Logging \textcolor{keyword}{import} Log, LogLevel}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00011}00011 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00012}00012 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00013}\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface}{00013}} \textcolor{keyword}{class }\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface}{WhisperInterface}}:}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00014}00014 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00015}00015     \textcolor{keyword}{def }\_\_init\_\_(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00016}00016         self,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00017}00017         model\_name: str = \textcolor{stringliteral}{"{}distil-\/small.en"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00018}00018         device: str = \textcolor{stringliteral}{"{}auto"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00019}00019         cpu\_threads: int = 4,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00020}00020         transcribe\_workers: int = 2,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00021}00021         compute\_type: str = \textcolor{stringliteral}{"{}default"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00022}00022     ):}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00023}00023         \textcolor{comment}{\# Whisper Focused Variables}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00024}00024         self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a96b55c7a69bb69d66ff8074256891373}{whisper\_model}} = WhisperModel(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00025}00025             model\_name,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00026}00026             device=device,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00027}00027             compute\_type=compute\_type,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00028}00028             num\_workers=transcribe\_workers,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00029}00029             cpu\_threads=cpu\_threads,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00030}00030             local\_files\_only=\textcolor{keyword}{True},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00031}00031         )}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00032}00032         self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a742c06519e747e542d6a2297fa46f8a9}{beam\_size}} = 5}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00034}00034     \textcolor{keyword}{def }\_\_del\_\_(self):}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00035}00035         del self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a96b55c7a69bb69d66ff8074256891373}{whisper\_model}}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00037}00037     \textcolor{keyword}{def }process\_file\_from\_dir(self, filepath: str):}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00038}00038 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00039}00039         segments, info = self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a96b55c7a69bb69d66ff8074256891373}{whisper\_model}}.transcribe(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00040}00040             filepath,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00041}00041             beam\_size=self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a742c06519e747e542d6a2297fa46f8a9}{beam\_size}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00042}00042             language=\textcolor{stringliteral}{"{}en"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00043}00043             prepend\_punctuations=\textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00044}00044             append\_punctuations=\textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00045}00045             vad\_filter=\textcolor{keyword}{True},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00046}00046         )}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00048}00048         Log(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00049}00049             f\textcolor{stringliteral}{"{}WhisperInterface | Detected Language: \{info.language\} | Probability: \{info.language\_probability\} | Duration: \{info.duration\}"{}}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00050}00050         )}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00052}00052         \textcolor{keywordflow}{for} segment \textcolor{keywordflow}{in} segments:}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00053}00053             Log(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00054}00054                 f\textcolor{stringliteral}{"{}WhisperInterface | Segment : \{segment.text\} | Start: \{segment.start\} | End: \{segment.end\}"{}}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00055}00055             )}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00056}00056 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00057}00057         \textcolor{keywordflow}{return} list(segments)}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00058}00058 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00059}00059     \textcolor{keyword}{def }process\_audio\_buffer(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00060}00060         self, audio\_buffer: np.ndarray}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00061}00061     ) -\/> tuple[list[Segment], dict]:}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00062}00062 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00063}00063         segments, info = self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a96b55c7a69bb69d66ff8074256891373}{whisper\_model}}.transcribe(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00064}00064             audio\_buffer,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00065}00065             beam\_size=self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a742c06519e747e542d6a2297fa46f8a9}{beam\_size}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00066}00066             language=\textcolor{stringliteral}{"{}en"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00067}00067         )}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00069}00069         Log(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00070}00070             f\textcolor{stringliteral}{"{}WhisperInterface || Detected Language: \{info.language\} | Probability: \{info.language\_probability\} | Duration: \{info.duration\}"{}}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00071}00071         )}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00073}00073         collected\_metadata = \{}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00074}00074             \textcolor{stringliteral}{"{}duration"{}}: info.duration,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00075}00075             \textcolor{stringliteral}{"{}language"{}}: info.language,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00076}00076             \textcolor{stringliteral}{"{}language\_probability"{}}: info.language\_probability,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00077}00077         \}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00079}00079         \textcolor{keywordflow}{return} list(segments), collected\_metadata}

\end{DoxyCode}
