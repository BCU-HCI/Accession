\hypertarget{WhisperInterface_8py_source}{}\doxysection{Whisper\+Interface.\+py}
\label{WhisperInterface_8py_source}\index{Content/Python/OpenAccessibilityPy/WhisperInterface.py@{Content/Python/OpenAccessibilityPy/WhisperInterface.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00001}00001 \textcolor{keyword}{from} ctypes \textcolor{keyword}{import} Union}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00002}00002 \textcolor{keyword}{import} numpy \textcolor{keyword}{as} np}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00003}00003 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00004}00004 \textcolor{keyword}{from} faster\_whisper \textcolor{keyword}{import} WhisperModel}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00005}00005 \textcolor{keyword}{from} faster\_whisper.transcribe \textcolor{keyword}{import} Segment}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00006}00006 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00007}00007 \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00008}00008     \textcolor{keyword}{from} .Logging \textcolor{keyword}{import} Log, LogLevel}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00009}00009 \textcolor{keywordflow}{except} ImportError:}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00010}00010     \textcolor{keyword}{from} Logging \textcolor{keyword}{import} Log, LogLevel}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00011}00011 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00012}00012 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00013}\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface}{00013}} \textcolor{keyword}{class }\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface}{WhisperInterface}}:}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00014}00014     \textcolor{stringliteral}{"{}"{}"{}Interface Class for Interacting with the CTranslate2 Faster Whisper Model."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00015}00015 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00016}\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a1ad0163d20eccfe3cfe53a5429439c81}{00016}}     \textcolor{keyword}{def }\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a1ad0163d20eccfe3cfe53a5429439c81}{\_\_init\_\_}}(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00017}00017         self,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00018}00018         model\_name: str = \textcolor{stringliteral}{"{}distil-\/small.en"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00019}00019         device: str = \textcolor{stringliteral}{"{}auto"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00020}00020         cpu\_threads: int = 4,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00021}00021         transcribe\_workers: int = 2,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00022}00022         compute\_type: str = \textcolor{stringliteral}{"{}default"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00023}00023     ):}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00024}00024         \textcolor{stringliteral}{"{}"{}"{}Constructor of Whisper Interface Class}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00025}00025 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00026}00026 \textcolor{stringliteral}{        Args:}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00027}00027 \textcolor{stringliteral}{            model\_name (str, optional): Hugging-\/Face Model Specifier }\textcolor{keywordflow}{for} CTranslate Compatible Models. Defaults to \textcolor{stringliteral}{"{}distil-\/small.en"{}}.}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00028}00028             device (str, optional): Device host \textcolor{keywordflow}{for} the Whisper Model (Can be \textcolor{stringliteral}{"{}auto"{}}, \textcolor{stringliteral}{"{}cpu"{}}, \textcolor{stringliteral}{"{}cuda"{}}). Defaults to \textcolor{stringliteral}{"{}auto"{}}.}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00029}00029             cpu\_threads (int, optional): Amount of CPU Threads to use, \textcolor{keywordflow}{if} Hosting the Model on a CPU. Defaults to 4.}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00030}00030             transcribe\_workers (int, optional): Amount of Thread Workers \textcolor{keywordflow}{for} Audio Transcription. Defaults to 2.}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00031}00031             compute\_type (str, optional): Data Structure \textcolor{keywordflow}{for} Whisper Compute. Defaults to \textcolor{stringliteral}{"{}default"{}}.}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00032}00032         \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00033}00033 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00034}00034 \textcolor{stringliteral}{        }\textcolor{comment}{\# Whisper Focused Variables}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00035}00035         self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a96b55c7a69bb69d66ff8074256891373}{whisper\_model}} = WhisperModel(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00036}00036             model\_name,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00037}00037             device=device,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00038}00038             compute\_type=compute\_type,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00039}00039             num\_workers=transcribe\_workers,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00040}00040             cpu\_threads=cpu\_threads,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00041}00041             local\_files\_only=\textcolor{keyword}{True},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00042}00042         )}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00043}00043         self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a742c06519e747e542d6a2297fa46f8a9}{beam\_size}} = 5}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00044}00044 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00045}\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a985f6d04116ed2267306a40583e8d574}{00045}}     \textcolor{keyword}{def }\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a985f6d04116ed2267306a40583e8d574}{\_\_del\_\_}}(self):}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00046}00046         \textcolor{stringliteral}{"{}"{}"{}Destructor of Whisper Interface Class."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00048}00048         del self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a96b55c7a69bb69d66ff8074256891373}{whisper\_model}}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00049}00049 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00050}\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a31890d94170946f043c39b82fa023723}{00050}}     \textcolor{keyword}{def }\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a31890d94170946f043c39b82fa023723}{process\_file\_from\_dir}}(self, filepath: str):}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00051}00051         \textcolor{stringliteral}{"{}"{}"{}Transcribes an Audio Files from a Given WAV File Path.}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00052}00052 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00053}00053 \textcolor{stringliteral}{        Args:}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00054}00054 \textcolor{stringliteral}{            filepath (str): Path to the Audio Files to Transcribe.}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00055}00055 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00056}00056 \textcolor{stringliteral}{        Returns:}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00057}00057 \textcolor{stringliteral}{            A List of Segments containing the Transcribed Text }\textcolor{keywordflow}{and} their Time Stamps.}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00058}00058         \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00059}00059 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00060}00060 \textcolor{stringliteral}{        segments, info = self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a96b55c7a69bb69d66ff8074256891373}{whisper\_model}}.transcribe(}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00061}00061 \textcolor{stringliteral}{            filepath,}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00062}00062 \textcolor{stringliteral}{            beam\_size=self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a742c06519e747e542d6a2297fa46f8a9}{beam\_size}},}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00063}00063 \textcolor{stringliteral}{            language="{}en"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00064}00064             prepend\_punctuations=\textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00065}00065             append\_punctuations=\textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00066}00066             vad\_filter=\textcolor{keyword}{True},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00067}00067         )}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00069}00069         Log(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00070}00070             f\textcolor{stringliteral}{"{}WhisperInterface | Detected Language: \{info.language\} | Probability: \{info.language\_probability\} | Duration: \{info.duration\}"{}}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00071}00071         )}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00073}00073         \textcolor{keywordflow}{for} segment \textcolor{keywordflow}{in} segments:}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00074}00074             Log(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00075}00075                 f\textcolor{stringliteral}{"{}WhisperInterface | Segment : \{segment.text\} | Start: \{segment.start\} | End: \{segment.end\}"{}}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00076}00076             )}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00078}00078         \textcolor{keywordflow}{return} list(segments)}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00079}00079 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00080}\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a8f73248120668faffa15af7e179f1704}{00080}}     \textcolor{keyword}{def }\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a8f73248120668faffa15af7e179f1704}{process\_audio\_buffer}}(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00081}00081         self, audio\_buffer: np.ndarray}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00082}00082     ) -\/> tuple[list[Segment], dict]:}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00083}00083         \textcolor{stringliteral}{"{}"{}"{}Transcribes an NDArray AudioBuffer.}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00084}00084 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00085}00085 \textcolor{stringliteral}{        Args:}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00086}00086 \textcolor{stringliteral}{            audio\_buffer (np.ndarray): AudioBuffer to Transcribe.}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00087}00087 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00088}00088 \textcolor{stringliteral}{        Returns:}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00089}00089 \textcolor{stringliteral}{            tuple[list[Segment], dict]: Tuple Containing a List of Transcription Segments }\textcolor{keywordflow}{and} a Dictionary of Collected Metadata.}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00090}00090         \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00091}00091 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00092}00092 \textcolor{stringliteral}{        segments, info = self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a96b55c7a69bb69d66ff8074256891373}{whisper\_model}}.transcribe(}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00093}00093 \textcolor{stringliteral}{            audio\_buffer,}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00094}00094 \textcolor{stringliteral}{            beam\_size=self.\mbox{\hyperlink{classOpenAccessibilityPy_1_1WhisperInterface_1_1WhisperInterface_a742c06519e747e542d6a2297fa46f8a9}{beam\_size}},}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00095}00095 \textcolor{stringliteral}{            language="{}en"{}},}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00096}00096         )}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00097}00097 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00098}00098         Log(}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00099}00099             f\textcolor{stringliteral}{"{}WhisperInterface || Detected Language: \{info.language\} | Probability: \{info.language\_probability\} | Duration: \{info.duration\}"{}}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00100}00100         )}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00101}00101 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00102}00102         collected\_metadata = \{}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00103}00103             \textcolor{stringliteral}{"{}duration"{}}: info.duration,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00104}00104             \textcolor{stringliteral}{"{}language"{}}: info.language,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00105}00105             \textcolor{stringliteral}{"{}language\_probability"{}}: info.language\_probability,}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00106}00106         \}}
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00107}00107 }
\DoxyCodeLine{\Hypertarget{WhisperInterface_8py_source_l00108}00108         \textcolor{keywordflow}{return} list(segments), collected\_metadata}

\end{DoxyCode}
